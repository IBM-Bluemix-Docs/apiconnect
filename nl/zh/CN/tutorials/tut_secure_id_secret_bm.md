---
copyright:
  years: 2017
lastupdated: "2017-10-31"
---

{:new_window: target="blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# 通过 {{site.data.keyword.Bluemix_notm}} 使用客户机标识和客户机私钥保护 API

**持续时间**：10 分钟  
**技能级别**：初学者


## 目标

本教程将指导您逐步完成使用客户机标识和客户机私钥来保护 API 的过程。在开发者门户网站中注册应用程序时，会生成客户机标识以标识应用程序。（可选）还可以生成用作密码的客户机私钥。应用程序需要提供生成的客户机标识和客户机私钥才能访问 API。


## 先决条件

开始之前，必须已完成以下其中一个教程： 
- [导入 OpenAPI2.0 规范并代理现有 REST 服务](tut_rest_landing.html)  
**或**  
- [添加新的 API 规范并调用现有 REST 服务](tut_rest_landing.html)


## 设置 API 的标识机制

1. 导航至 API 的“设计”视图：  
   a. 单击左侧导航面板中的**草稿**  
   b. 然后单击 **API** 选项卡  
   c. 单击在先前教程中创建的 _Weather Provider API_。这将打开 API 的**设计**视图。  
   ![](images/1_goto_drafts_api.png)  

2. 在“设计”视图中：
    a. 向下滚动到**安全性定义**。  
    b. 单击**添加安全性定义**图标 (+)，然后单击 **API 密钥**。  
    c. 添加如下所示的两个新 API 密钥。对于这两个新密钥，请确保“位于”字段设置为“头”。  
      - 名称：客户机标识；参数名称：X-IBM-Client-Id  
      - 名称：客户机私钥；参数名称：X-IBM-Client-Secret    
        ![](images/2_security_definitions.png)  

3. 向下滚动到**安全性**面板，然后添加新的安全性选项。  
    a. 选择新创建的“客户机标识”和“客户机私钥”。  
    b. 保存 API。  
    c. 切换到**组合**选项卡。  
    ![](images/3_security_option.png)  


## 测试对 API 所做的更改

1. 在“组合”选项卡中，单击 ► 按钮以测试更改。

2. 在“测试/设置”面板中，单击**重新发布产品**以获取最新更改。 
> 此选项将更新 API 产品，并将其发布到“沙箱”目录。

3. 重新发布该产品后，单击“测试”面板中的 **get /current** 操作。
4. 在“测试”面板中向下滚动，并注意“客户机标识”和“客户机私钥”值是否已填充。 
> 这些是针对沙箱生成的测试值，表示将使用 API 的应用程序的密钥。
>**注：**还可以在“仪表板”>“目录”>“设置”>“端点”下找到“客户机标识”和“客户机私钥”。   
  
  ![](images/test_api_keys_1.png)

5. 进一步向下滚动并输入邮政编码（例如 90210）。 
6. 单击**调用**。_您应该会获得 200 OK 响应，以及返回天气信息的消息体。_
7. 现在向上滚动回“客户机标识”字段。 
8. 将“客户机标识”值替换为随机值。
9. 通过单击**调用**来重新运行测试。_您将看到 401 Unauthorized 响应以及“客户机标识未注册”消息。_  

    ![](images/test_api_keys_3.png)  


## 使用客户机标识和客户机私钥调用 API

还可以使用显式调用代理端点的浏览工具来测试安全设置，并将“客户机标识”和“客户机私钥”作为头值传递。

1. 单击**浏览**，然后单击**沙箱**。
    ![](images/explore_1.png)

2. 单击列表中的 **GET /current** 操作。

3. 在右侧列中，单击**调用操作**以重新运行测试。
![](images/explore_3.png)

---

## 结论
在本教程中，您已学习如何设置 API 的标识机制，测试对 API 所做的更改，并使用客户机标识和客户机私钥调用了 API。 

---

## 下一步

通过[设置和配置开发者门户网站](tut_config_dev_portal.html)，开始对 API 社交化。

创建 > 管理 > **安全** > 社交化 > 分析
